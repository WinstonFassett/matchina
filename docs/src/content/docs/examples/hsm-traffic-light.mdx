---
title: Hierarchical Traffic Light
description: Comparison of flattened vs propagating hierarchical state machines
---

import Example from "@code/examples/hsm-traffic-light/example";
import flatMachineCode from "@code/examples/hsm-traffic-light/machine-flat.ts?raw";
import propMachineCode from "@code/examples/hsm-traffic-light/machine-prop.ts?raw";
import CodeTabs from "@components/CodeTabs.astro";

Toggle below to compare flattened vs nested (propagating) HSM implementations.

<div className="not-content">
  <Example client:only="react" />
</div>

## Comparison

| Feature | Flattened (Flat) | Nested (Propagating) |
| :--- | :--- | :--- |
| **Runtime Structure** | Single Machine | Tree of Machines |
| **State Key** | `"Parent.Child"` | `"Parent"` (Child hidden in data) |
| **Event Handling** | O(1) Lookup | Recursive Bubble/Capture |
| **Serialization** | Simple String | Complex (Recursive Data) |
| **Use Case** | Static hierarchy (UI flows, wizards) | Dynamic composition, independent actors |

## Code

<CodeTabs
  files={[
    { name: "machine-flat.ts", code: flatMachineCode },
    { name: "machine-prop.ts", code: propMachineCode },
  ]}
/>
