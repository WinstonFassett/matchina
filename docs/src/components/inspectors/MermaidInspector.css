/* Simple Mermaid theme CSS - this gets injected via themeCSS, not as a stylesheet */

/* Fix node styling - only text, let nodes keep natural colors */
.node text {
  fill: var(--sl-color-text);
}

/* Fix start state circles for dark theme */
.node circle.state-start {
  fill: var(--sl-color-text);
  stroke: var(--sl-color-text);
}

/* Dark mode fixes for start states */
html[data-theme="dark"] .node circle.state-start {
  fill: var(--sl-color-text);
  stroke: var(--sl-color-text);
}

/* Fix state nodes */
.state rect {
  fill: var(--sl-color-gray-2);
  stroke: var(--sl-color-gray-5);
  rx: 10;
  ry: 10;
}

/* State diagram default nodes - dark mode */
html[data-theme="dark"] .state-diagram-v2 g.state-node path,
html[data-theme="dark"] g[class*="state"] path:not([class*="active"]) {
  fill: transparent !important;
  stroke: var(--sl-color-accent-high) !important;
  stroke-width: 2px !important;
}

/* State rect styling */
.state rect {
  fill: var(--sl-color-gray-2);
  stroke: var(--sl-color-gray-5);
  rx: 10;
  ry: 10;
}

/* Dark mode: transparent state rects */
html[data-theme="dark"] .state rect {
  fill: transparent !important;
  stroke: var(--sl-color-accent-high) !important;
}

.state text {
  fill: var(--sl-color-text);
}

/* Flowchart node styling */
.node rect {
  fill: var(--sl-color-gray-2) !important;
  stroke: var(--sl-color-gray-5) !important;
  rx: 10;
  ry: 10;
}

/* Dark mode: transparent flowchart nodes */
html[data-theme="dark"] .node rect {
  fill: transparent !important;
  stroke: var(--sl-color-accent-high) !important;
}

/* Dark mode: default flowchart paths transparent */
html[data-theme="dark"] g.node path {
  fill: transparent !important;
  stroke: var(--sl-color-accent-high) !important;
}





/* Fix state diagram groups/clusters - transparent on both themes */
.statediagram-cluster rect,
.statediagram-cluster.statediagram-cluster .inner rect,
.statediagram-cluster .inner rect,
#mermaid-1 .statediagram-cluster rect,
#mermaid-1 .statediagram-cluster .inner rect {
  fill: transparent !important;
  background: transparent !important;
}

/* Dark mode - keep transparent */
html[data-theme="dark"] .statediagram-cluster rect,
html[data-theme="dark"] .statediagram-cluster .inner rect,
html[data-theme="dark"] .statediagram-cluster.statediagram-cluster .inner rect,
html[data-theme="dark"] #mermaid-1 .statediagram-cluster rect,
html[data-theme="dark"] #mermaid-1 .statediagram-cluster .inner rect {
  fill: transparent !important;
  background: transparent !important;
}

/* Edge labels with better contrast */
.edgeLabel text { 
  fill: var(--sl-color-text) !important; 
}
.edgeLabel rect {
  fill: var(--sl-color-bg) !important;
  stroke: var(--sl-color-gray-4) !important;
}
.edgeLabel p {
  border: none !important;
}

/* Dark mode edge label fixes */
html[data-theme="dark"] .edgeLabel rect {
  fill: var(--sl-color-gray-2) !important;
  stroke: var(--sl-color-gray-5) !important;
}

/* Flowchart cluster styling removed - handled in mermaid.css */

/* Dark mode flowchart cluster fixes - MOVED TO mermaid.css */

/* Fix edge visibility */
.transition,
.flowchart-link {
  stroke: var(--sl-color-text) !important;
}

/* Edge label styling classes for interactivity */
.edge-active {
  background-color: var(--sl-color-gray-5) !important;
  color: var(--sl-color-accent-high) !important;
  font-weight: 600 !important;
}

.edge-ancestor {
  background-color: var(--sl-color-gray-4) !important;
  color: var(--sl-color-accent-high) !important;
  font-weight: 400 !important;
}

.edge-inactive {
  background-color: var(--sl-color-bg) !important;
  color: var(--sl-color-gray-4) !important;
  cursor: default !important;
  opacity: 0.7 !important;
}

.edge-interactive {
  text-decoration: underline !important;
  cursor: pointer !important;
  position: relative;
  z-index: 10 !important;
}

.edge-ancestor.edge-interactive:hover {
  background-color: var(--sl-color-accent-high) !important;
  color: var(--sl-color-text-invert) !important;
}

.edge-active.edge-interactive:hover {
  background-color: var(--sl-color-accent) !important;
  color: var(--sl-color-text-invert) !important;
}

/* Dark mode improvements for edge labels */
html[data-theme="dark"] .edge-inactive {
  background-color: var(--sl-color-gray-2) !important;
  color: var(--sl-color-gray-5) !important;
}

/* State highlight styling */
/* Dark mode: transparent/black fill - override inline styles */
html[data-theme="dark"] .state-highlight path,
html[data-theme="dark"] .state-highlight path[style] {
  fill: transparent !important;
  stroke: var(--sl-color-accent-high) !important;
  stroke-width: 2px !important;
}

/* Light mode: purple fill */
html:not([data-theme="dark"]) .state-highlight path {
  fill: rgb(147, 112, 219) !important;
  stroke: rgb(147, 112, 219) !important;
  stroke-width: 2px !important;
}

/* Dark mode: dark text on active */
html[data-theme="dark"] .state-highlight text,
html[data-theme="dark"] .state-highlight p {
  fill: #1f2937 !important;
  color: #1f2937 !important;
}

/* Light mode: white text on active */
html:not([data-theme="dark"]) .state-highlight text,
html:not([data-theme="dark"]) .state-highlight p {
  fill: #ffffff !important;
  color: #ffffff !important;
}

/* Flowchart active node */
/* Dark mode: transparent/black fill - override inline styles */
html[data-theme="dark"] .node.active path,
html[data-theme="dark"] .node.active path[style] {
  fill: transparent !important;
  stroke: var(--sl-color-accent-high) !important;
  stroke-width: 2px !important;
}

/* Light mode: purple fill */
html:not([data-theme="dark"]) .node.active path {
  fill: rgb(147, 112, 219) !important;
  stroke: rgb(147, 112, 219) !important;
}

/* Dark mode: active node text should be dark */
html[data-theme="dark"] .node.active text,
html[data-theme="dark"] .node.active p {
  fill: #1f2937 !important;
  color: #1f2937 !important;
}

/* Light mode: active node text should be white */
html:not([data-theme="dark"]) .node.active text,
html:not([data-theme="dark"]) .node.active p {
  fill: #ffffff !important;
  color: #ffffff !important;
}

.state-container-highlight rect {
  stroke: var(--sl-color-accent-high) !important;
  stroke-width: 2px !important;
  fill: var(--sl-color-accent-high) !important;
  fill-opacity: 0.15 !important;
}

html[data-theme="dark"] .state-container-highlight rect {
  fill-opacity: 0.25 !important;
}