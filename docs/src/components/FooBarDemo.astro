---
import { MermaidInspector } from "matchina/viz";
import { buildVisualizerTree } from "@code/examples/lib/matchina-machine-to-xstate-definition";
import { createMachine, defineStates, type FactoryMachine } from "matchina";

const states = defineStates( {
  Idle: undefined,
  Foo: (foo: string) => ({ foo }),
  Bar: (bar: number) => ({ bar })
})
const machine = createMachine(
  states, 
  {
    Idle: {
      toggle: 'Foo'
    },
    Foo: {
      toggle: 'Bar',
      foo: (foo = 'foo') => states.Foo(`my-${foo}`),      
    },
    Bar: {
      toggle: 'Foo',
      increment: (bar: number) => (ev) => 
        states.Bar(ev?.from.data.bar + bar)
    }
  }, 
  'Idle'
)
const config = buildVisualizerTree(machine as FactoryMachine<any>)

---

<MermaidInspector config={config} stateKey="Idle" client:only="react"  />