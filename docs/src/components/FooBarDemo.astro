---
import StateMachineMermaidDiagram from "@components/MachineViz";
import { getXStateDefinition } from "@code/examples/StopwatchCommon";
import { createMachine, defineStates, type FactoryMachine } from "matchina";

const states = defineStates( {
  Idle: undefined,
  Foo: (foo: string) => ({ foo }),
  Bar: (bar: number) => ({ bar })
})
const machine = createMachine(
  states, 
  {
    Idle: {
      toggle: 'Foo'
    },
    Foo: {
      toggle: 'Bar',
      foo: (foo = 'foo') => states.Foo(`my-${foo}`),      
    },
    Bar: {
      toggle: 'Foo',
      increment: (bar: number) => (ev) => 
        states.Bar(ev?.from.data.bar + bar)
    }
  }, 
  'Idle'
)
const config = getXStateDefinition(machine as FactoryMachine<any>)

---

<StateMachineMermaidDiagram config={config} stateKey="Idle" client:visible  />